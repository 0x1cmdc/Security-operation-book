# T1588-004-获取能力-数字证书

## 来自ATT&CK的描述

在入侵受害者之前，攻击者可能会购买或窃取可在目标定位期间使用的自签名SSL/TLS证书。 SSL/TLS证书旨在确保信任，它们包括密钥的信息，所有者身份的信息以及已验证证书内容正确的实体的数字签名。如果签名有效，并且检查证书的人员信任签名者，则他们知道可以使用该密钥与其所有者进行通信。

攻击者可能会购买或窃取SSL/TLS证书，这些证书可用于进一步进行操作，例如加密C2流量（例如：Web协议），甚至使中间人攻击成为可能，如果在证书被添加到信任根（即安装根证书）。攻击者可以使用傀儡组织或使用从先前被入侵的实体窃取的信息来完成数字证书的购买，这些信息可以使攻击者冒充受该实体通过证书颁发者的验证。攻击者也可能直接从被入侵的第三方窃取代码签名材料。

现有的证书颁发机构允许攻击者免费获取SSL/TLS证书，例如域名验证证书。

攻击者可能会注册或劫持将在以后购买SSL/TLS证书的域名。

## 测试案例

暂无

## 检测日志

无法有效监测

## 测试复现

无

## 测试留痕

无

## 检测规则/思路

无

## 建议

### 缓解措施

这种技术不容易用预防控制来缓解，因为它是基于企业防御和控制范围之外的行为。

### 检测

考虑使用可能有助于跟踪新颁发的证书或互联网上的网站使用的证书的服务。在某些情况下，有可能通过已知的证书信息来发现其他攻击者的基础设施。攻击者工具的一些服务器端组件可能为SSL/TLS证书设置了默认值。

检测工作可能集中在相关行为上，如网络协议、非对称加密或安装根证书。

## 参考推荐

MITRE-ATT&CK-T1588-004

<https://attack.mitre.org/techniques/T1588/004/>
